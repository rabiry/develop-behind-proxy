



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-0.17.3, mkdocs-material-2.7.3">
    
    
      
        <title>Know your proxy - develop-behind-proxy</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application.8d40d89b.css">
      
    
    
      <script src="../assets/javascripts/modernizr.1aa3b519.js"></script>
    
    
      <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
      
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="drawer"></label>
    
      <a href="#know-your-proxy" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href=".." title="develop-behind-proxy" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                develop-behind-proxy
              </span>
              <span class="md-header-nav__topic">
                Know your proxy
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://github.com/smarie/develop-behind-proxy/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      GitHub
    </div>
  </a>

          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="drawer">
    <span class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </span>
    develop-behind-proxy
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/smarie/develop-behind-proxy/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      GitHub
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../basics/" title="HTTP/HTTPs Proxy basics" class="md-nav__link">
      HTTP/HTTPs Proxy basics
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="toc">
        Know your proxy
      </label>
    
    <a href="./" title="Know your proxy" class="md-nav__link md-nav__link--active">
      Know your proxy
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#basics" title="Basics" class="md-nav__link">
    Basics
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#auto-configuration-scripts" title="Auto-configuration scripts" class="md-nav__link">
    Auto-configuration scripts
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#advanced-proxies-that-modify-the-ssl-certification-chain" title="Advanced: proxies that modify the SSL certification chain" class="md-nav__link">
    Advanced: proxies that modify the SSL certification chain
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#check-if-your-proxy-needs-to-be-trusted" title="Check if your proxy needs to be trusted" class="md-nav__link">
    Check if your proxy needs to be trusted
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#download-your-proxys-root-certificate" title="Download your proxy's root certificate" class="md-nav__link">
    Download your proxy's root certificate
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-a-certificate-bundle-including-your-proxys-root-certificate" title="Create a certificate bundle including your proxy's root certificate" class="md-nav__link">
    Create a certificate bundle including your proxy's root certificate
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../configure_apps/" title="Configure your applications" class="md-nav__link">
      Configure your applications
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../switching/" title="Switching tools" class="md-nav__link">
      Switching tools
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#basics" title="Basics" class="md-nav__link">
    Basics
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#auto-configuration-scripts" title="Auto-configuration scripts" class="md-nav__link">
    Auto-configuration scripts
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#advanced-proxies-that-modify-the-ssl-certification-chain" title="Advanced: proxies that modify the SSL certification chain" class="md-nav__link">
    Advanced: proxies that modify the SSL certification chain
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#check-if-your-proxy-needs-to-be-trusted" title="Check if your proxy needs to be trusted" class="md-nav__link">
    Check if your proxy needs to be trusted
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#download-your-proxys-root-certificate" title="Download your proxy's root certificate" class="md-nav__link">
    Download your proxy's root certificate
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-a-certificate-bundle-including-your-proxys-root-certificate" title="Create a certificate bundle including your proxy's root certificate" class="md-nav__link">
    Create a certificate bundle including your proxy's root certificate
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/smarie/develop-behind-proxy/edit/master/docs/know_your_proxy.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="know-your-proxy">Know your proxy<a class="headerlink" href="#know-your-proxy" title="Permanent link">&para;</a></h1>
<p>Before configuring your computer applications to work with your proxy, you have to know which configuration settings to apply.</p>
<h2 id="basics">Basics<a class="headerlink" href="#basics" title="Permanent link">&para;</a></h2>
<p>These can typically be obtained from your IT department:</p>
<ul>
<li>the proxy's <strong>host</strong> and <strong>port</strong> for the two protocols (HTTP and HTTPs). For example <code>http://proxyhost:8080</code> and <code>https://proxyhost:4443</code></li>
<li>the <strong>list of hosts that do not require a proxy</strong>, in other words the hosts for which the applications should still use a direct connection. These are typically computers located in the intranet, but also some external hosts that have been put in a 'whitelist' by your IT department. For example <code>localhost,127.0.0.1,mylocalserver</code></li>
<li>(optional) your credentials (<strong>username</strong> and <strong>password</strong>). Note that NTML proxies such as ZScaler do not require this - this is even dangerous in term of security to write your username and password in a file or an environment variable, so we don't recommend it</li>
</ul>
<h2 id="auto-configuration-scripts">Auto-configuration scripts<a class="headerlink" href="#auto-configuration-scripts" title="Permanent link">&para;</a></h2>
<p>Some tools are able to get their configuration with "auto-config" from a <code>.pac</code> script. If your organization provides such a script, make sure that you retrieve it.</p>
<h2 id="advanced-proxies-that-modify-the-ssl-certification-chain">Advanced: proxies that modify the SSL certification chain<a class="headerlink" href="#advanced-proxies-that-modify-the-ssl-certification-chain" title="Permanent link">&para;</a></h2>
<p>Some proxies such as <em>ZScaler</em> modify the SSL certification chain by replacing the root Certification Authority (CA)'s certificate signature with their own CA certificate. </p>
<p>In these cases, you will have to tell all your software applications to <strong>trust</strong> this new CA certificate. We will see below how to do that, but first let's check if you need it with your proxy.</p>
<h3 id="check-if-your-proxy-needs-to-be-trusted">Check if your proxy needs to be trusted<a class="headerlink" href="#check-if-your-proxy-needs-to-be-trusted" title="Permanent link">&para;</a></h3>
<p>To check if your proxy changes the certification chain, here is the procedure on <em>Firefox</em> (but you can probably find equivalent possibilities in other browsers):</p>
<ul>
<li>connect to any https page such as <a href="https://google.com">https://google.com</a></li>
<li>click on the small 'locker' icon at the left of the URL bar</li>
<li>extend the popup. It should state "secure connection, verified by <code>xxx</code>":</li>
</ul>
<p><img alt="Checking if your proxy changes the certification chain" src="../example2.png" /></p>
<ul>
<li>if <code>xxx</code> has the name of your proxy (in this example, <em>Zscaler</em>) instead of being a known certification authority (such as DigiCert, Thawte, Verisign, Symantec, etc.), that means that your proxy has modified the certification chain. Otherwise, that means that either your proxy does not modify it, or bad luck : you picked a site that is in the whitelist :) select another https url and try again, to be sure. </li>
</ul>
<h3 id="download-your-proxys-root-certificate">Download your proxy's root certificate<a class="headerlink" href="#download-your-proxys-root-certificate" title="Permanent link">&para;</a></h3>
<p>If the test was positive, you will need to download the proxy's CA certificate in order to be able to trust it. For this:</p>
<ul>
<li>Click on <code>More Information &gt; View Certificate &gt; Details</code>. </li>
</ul>
<p><img alt="Exporting the root certificate" src="../example3.png" /></p>
<ul>
<li>Select the ROOT certificate, at the top of the hierarchy - not the intermediate ones ! - and export it as a <code>*.crt</code> or <code>*.cer</code> file. If your browser asks you which certificate format is needed, select <code>base64</code>. This format is a string representation of the certificate's bytes, so you may open the file in Notepad and copy/paste the certificate easily if you need to.</li>
</ul>
<p>You now have a <code>my_proxys_root_ca_cert.cer</code> file. </p>
<p><em>Note: <code>.cer</code>, <code>.crt</code> and <code>.pem</code> are both valid extensions for such a <code>base64</code> encoded file, see <a href="https://support.ssl.com/Knowledgebase/Article/View/19/0/der-vs-crt-vs-cer-vs-pem-certificates-and-how-to-convert-them">this article</a>. They can be opened with a text editor if needed.</em></p>
<h3 id="create-a-certificate-bundle-including-your-proxys-root-certificate">Create a certificate bundle including your proxy's root certificate<a class="headerlink" href="#create-a-certificate-bundle-including-your-proxys-root-certificate" title="Permanent link">&para;</a></h3>
<p>As we'll see in the next session, some tools are able to support addition of trusted certificates one by one (= separate certificate files), while some others only support changing the whole trusted certificate bundle entirely (= a single file containing all trusted certificates). </p>
<p>You will therefore need to build such a certificate bundle file. This is done by appending your proxy's root certificate (<code>my_proxys_root_ca_cert.cer</code>, downloaded in previous section) to an <strong>existing</strong> certificate bundle.</p>
<ul>
<li>Get an existing certificate bundle. For example you may wish to get it from <a href="https://certifi.io/en/latest/">certifi</a> by downloading it from this adress: <a href="https://mkcert.org/generate/">certs.pem</a>. <strong>IMPORTANT</strong> please check that this link is still the link recommended by certifi.io! Downloading a compromised list of certificate authorities can enfringe your computer's (and IT dept) security rules, proceed with care and/or double-check with your IT department.</li>
<li>save the file somewhere on your computer, and rename it for example <code>160117-certifi-ca-bundle-with-proxy.pem</code>. Make sure that only administrator account has write permissions on this file. This will prevent programs to add other trusted certificates later on.</li>
<li>open it in your favorite text editor to edit it: at the end of the file, append your Proxy's certificate (the contents of the <code>my_proxys_root_ca_cert.cer</code> file downloaded in previous step). The bottom of the resulting certificate bundle file should therefore now look like this:</li>
</ul>
<div class="codehilite"><pre><span></span>(... end of the certs.pem file provided by certifi)
oyi3B43njTOQ5yOf+1CceWxG1bQVs5ZufpsMljq4Ui0/1lvh+wjChP4kqKOJ2qxq
4RgqsahDYVvTH9w7jXbyLeiNdd8XM2w9U/t7y0Ff/9yi0GE44Za4rF2LN9d11TPA
mRGunUHBcnWEvgJBQl9nJEiU0Zsnvgc/ubhPgXRR4Xq37Z0j4r7g1SgEEzwxA57d
emyPxgcYxn/eR44/KJ4EBs+lVDR3veyJm+kXQ99b21/+jh5Xos1AnX5iItreGCc=
-----END CERTIFICATE-----

My Proxy&#39;s Root CA
==================
-----BEGIN CERTIFICATE-----
MIAE07CCA7ugAwIBAgIJANu+mC2Jt3uTMA0GCSqGSIb3DQEBCwUAMIGhMQswCQYD
VQQGEwJVUzETMBEGA1UECBMKQ2FsaWZvcm5pYTERMA8GA1UEBxMIU2FuIEpvc2Ux
(... this is fairly long)
xFNjavxrHmsH8jPHVvgc1VD0Opja0l/BRVauTrUaoW6tE+wFG5rEcPGS80jjHK4S
pB5iDj2mUZH1T8lzYtuZy0ZPirxmtsk3135+CKNa2OCAhhFjE0xd
-----END CERTIFICATE-----
</pre></div>


<p>You are now all set :</p>
<ul>
<li>You have a <code>my_proxys_root_ca_cert.crt</code> file containing your proxy's certificate only. This will be referred to as <code>&lt;path_to_root_ca_cert.crt&gt;</code> in next section</li>
<li>You have a <code>160117-certifi-ca-bundle-with-proxy.pem</code> file containing a bundle of trusted certificates, as well as your proxy's. This will be referred to as <code>&lt;path_to_ca_bundle.pem&gt;</code> in next section</li>
</ul>
<p><em>(Remember that <code>.crt</code>, <code>.cer</code> and <code>.pem</code> are both valid extensions for these files)</em></p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../basics/" title="HTTP/HTTPs Proxy basics" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                HTTP/HTTPs Proxy basics
              </span>
            </div>
          </a>
        
        
          <a href="../configure_apps/" title="Configure your applications" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Configure your applications
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="http://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application.b438e6c5.js"></script>
      
      <script>app.initialize({version:"0.17.3",url:{base:".."}})</script>
      
    
    
      
    
  </body>
</html>